import{r as e,R as t,p as n,b as r,j as i,B as o,x as a,a2 as s,a3 as c,a4 as l,a5 as d,d as u,c as h,a6 as p,N as f,a7 as m,a8 as v,a9 as y,Q as _,L as b,E as g,aa as w,ab as x,ac as C,O as k,ad as O,ae as E,af as M,ag as N,ah as T,u as S,ai as A,aj as L,ak as D,g as B,C as j,S as P,al as z,am as R,an as q,ao as F,ap as U}from"./popup.js";import{C as W,B as I}from"./BaseModal.js";import{F as G,p as H,A as Y,I as K}from"./Fab.js";import{R as $,T as V}from"./TextFitler.js";import{f as X}from"./index2.js";import{R as Z}from"./rotate-cw.js";import{S as Q}from"./Select.js";import"./debounce.js";function J(){return J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},J.apply(this,arguments)}function ee(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var te=e.forwardRef(function(e,n){var r=e.color,i=void 0===r?"currentColor":r,o=e.size,a=void 0===o?24:o,s=ee(e,["color","size"]);return t.createElement("svg",J({ref:n,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},s),t.createElement("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"}))});te.propTypes={color:n.string,size:n.oneOfType([n.string,n.number])},te.displayName="Zap";const ne=te,re="_FlexCenter_1380a_1";function ie({children:e}){return r("div",{className:re,children:e})}const{useRef:oe,useEffect:ae}=a;function se({onClickPrimaryButton:e,onClickSecondaryButton:t}){const n=oe(null),a=oe(null);ae(()=>{n.current.focus()},[]);return i("div",{onKeyDown:e=>{39===e.keyCode?a.current.focus():37===e.keyCode&&n.current.focus()},children:[r("h2",{children:"Close Connections?"}),r("p",{children:"Click 'Yes' to close those connections that are still using the old selected proxy in this group"}),r("div",{style:{height:30}}),i(ie,{children:[r(o,{onClick:e,ref:n,children:"Yes"}),r("div",{style:{width:20}}),r(o,{onClick:t,ref:a,children:"No"})]})]})}const ce="_header_19ilz_1",le="_qty_19ilz_26";function de({name:t,type:n,toggle:o,qty:a}){const c=e.useCallback(e=>{e.preventDefault(),"Enter"!==e.key&&" "!==e.key||o()},[o]);return i("div",{className:ce,onClick:o,style:{cursor:"pointer"},tabIndex:0,onKeyDown:c,role:"button",children:[r("div",{children:r(s,{name:t,type:n})}),"number"==typeof a?r("span",{className:le,children:a}):null]})}const{useMemo:ue}=a;const he=(e,t)=>{if(e&&"number"==typeof e.number&&e.number>0)return e.number;const n=t&&t.type;return n&&d.indexOf(n)>-1?-1:999999},pe={Natural:e=>e,LatencyAsc:(e,t,n)=>e.sort((e,r)=>he(t[e],n&&n[e])-he(t[r],n&&n[r])),LatencyDesc:(e,t,n)=>e.sort((e,r)=>{const i=he(t[e],n&&n[e]);return he(t[r],n&&n[r])-i}),NameAsc:e=>e.sort(),NameDesc:e=>e.sort((e,t)=>e>t?-1:e<t?1:0)};function fe(e,t,n,r,i){const[o]=c(l);return ue(()=>function(e,t,n,r,i,o){let a=[...e];return n&&(a=function(e,t){return e.filter(e=>{const n=t[e];return void 0===n||0!==n.number})}(e,t)),"string"==typeof r&&""!==r&&(a=function(e,t){const n=t.toLowerCase().split(" ").map(e=>e.trim()).filter(e=>!!e);return 0===n.length?e:e.filter(e=>{let t=0;for(;t<n.length;t++){const r=n[t];if(e.toLowerCase().indexOf(r)>-1)return!0}return!1})}(a,r)),pe[i](a,t,o)}(e,t,n,o,r,i),[e,t,n,o,r,i])}const me={header:"_header_1qjca_1",group:"_group_1qjca_5",zapWrapper:"_zapWrapper_1qjca_12",arrow:"_arrow_1qjca_20",isOpen:"_isOpen_1qjca_25"},ve=13,ye="_proxy_xgbmr_4",_e="_now_xgbmr_25",be="_error_xgbmr_29",ge="_selectable_xgbmr_32",we="_proxyType_xgbmr_40",xe="_row_xgbmr_65",Ce="_proxyName_xgbmr_73",ke="_proxySmall_xgbmr_84",Oe="_proxyLatency_1h5y2_4";function Ee({number:e,color:t}){return r("span",{className:Oe,style:{color:t},children:i("span",{children:[e," ms"]})})}const{useMemo:Me}=a,Ne="#67c23a",Te="#d4b75c",Se="#e67f3c",Ae="#909399";function Le({number:e}={},t){return 0===e?Ae:e<(t?800:200)?Ne:e<(t?1500:500)?Te:"number"==typeof e?Se:Ae}const De=e=>({left:e.left+window.scrollX-5,top:e.top+window.scrollY-38});function Be({children:t,label:n,"aria-label":o}){const[a,s]=p();return i(f,{children:[e.cloneElement(t,a),r(m,{...s,label:n,"aria-label":o,position:De})]})}const je=(e,{name:t})=>{const n=v(e),r=y(e),i=_(e);return{proxy:n[t]||{name:t,history:[]},latency:r[t],httpsLatencyTest:i.startsWith("https://")}},Pe=u(je)(function({now:t,name:n,proxy:o,latency:a,httpsLatencyTest:s,isSelectable:c,onClick:l}){var d;const u=null==(d=o.history[o.history.length-1])?void 0:d.delay,p=(null==a?void 0:a.number)??u,f=Me(()=>Le({number:p},s),[p]),m=e.useCallback(()=>{c&&l&&l(n)},[n,l,c]),v=e.useCallback(e=>{e.keyCode===ve&&m()},[m]),y=Me(()=>h(ye,{[_e]:t,[be]:a&&a.error,[ge]:c}),[c,t,a]);return i("div",{tabIndex:0,className:y,onClick:m,onKeyDown:v,role:c?"menuitem":"",children:[i("div",{className:h(Ce,xe),children:[r(Be,{label:n,"aria-label":`proxy name: ${n}`,children:r("span",{children:n})}),r("span",{className:we,style:{paddingLeft:4,opacity:.6,color:"#51A8DD"},children:(b=o.udp,g=o.xudp,b?g?"XUDP":"UDP":"")})]}),i("div",{className:xe,children:[i("div",{className:xe,children:[r("span",{className:we,style:{paddingRight:4,opacity:.6,color:"#F596AA"},children:(_=o.type,"Shadowsocks"===_?"SS":_)}),function(e){return e?r("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2962",width:"10",height:"10",children:r("path",{d:"M648.093513 719.209284l-1.492609-40.940127 31.046263-26.739021c202.73892-174.805813 284.022131-385.860697 255.70521-561.306199-176.938111-28.786027-389.698834 51.857494-563.907604 254.511123l-26.31256 30.619803-40.38573-0.938211c-60.557271-1.407317-111.903014 12.79379-162.822297 47.0385l189.561318 127.084977-37.95491 68.489421c-9.126237 16.461343-0.554398 53.307457 29.084549 82.818465 29.5963 29.511008 67.380626 38.381369 83.287571 29.852176l68.318836-36.760822 127.639376 191.267156c36.163779-52.11337 50.450177-103.629696 48.189941-165.039887zM994.336107 16.105249l10.490908 2.686696 2.64405 10.405615c47.46496 178.089552-1.023503 451.492838-274.170913 686.898568 4.051367 111.263324-35.396151 200.222809-127.255561 291.741051l-15.779008 15.693715-145.934494-218.731157c-51.217805 27.59194-128.790816 10.405616-183.93205-44.522388-55.226525-55.013296-72.41285-132.287785-43.498885-184.529093L0.002773 430.325513l15.736362-15.65107c89.300652-88.959484 178.64395-128.108481 289.011709-125.549722C539.730114 15.806727 815.56422-31.061189 994.336107 16.105249zM214.93844 805.098259c28.572797 28.572797 22.346486 79.49208-12.537914 114.376479C156.428175 965.489735 34.034254 986.002445 34.034254 986.002445s25.331704-127.084978 66.612998-168.323627c34.8844-34.8844 85.633099-41.281295 114.291188-12.580559zM661.01524 298.549479a63.968948 63.968948 0 1 0 0 127.937897 63.968948 63.968948 0 0 0 0-127.937897z","p-id":"2963"})}):""}(o.tfo)]}),p?r(Ee,{number:p,color:f}):null]})]});var _,b,g}),ze=u(je)(function({now:t,name:n,proxy:i,latency:o,httpsLatencyTest:a,isSelectable:s,onClick:c}){var l;const d=null==(l=i.history[i.history.length-1])?void 0:l.delay,u=(null==o?void 0:o.number)??d,p=Me(()=>function(e,t){return Le(e,t)}({number:u},a),[u]),f=Me(()=>{let e=n;return o&&"number"==typeof o.number&&(e+=" "+o.number+" ms"),e},[n,o]),m=e.useCallback(()=>{s&&c&&c(n)},[n,c,s]),v=e.useCallback(e=>{e.keyCode===ve&&m()},[m]);return r("div",{title:f,className:h(ke,{[ge]:s}),style:{background:p,scale:t?"1.2":"1"},onClick:m,onKeyDown:v,role:s?"menuitem":"",children:t&&r("div",{className:_e})})}),Re="_list_4awfc_4",qe="_detail_4awfc_10",Fe="_summary_4awfc_19";function Ue({all:e,now:t,isSelectable:n,itemOnTapCallback:i}){const o=e;return r("div",{className:h(Re,qe),children:o.map(e=>r(Pe,{onClick:i,isSelectable:n,name:e,now:e===t},e))})}function We({all:e,now:t,isSelectable:n,itemOnTapCallback:i}){return r("div",{className:h(Re,Fe),children:e.map(e=>r(ze,{onClick:i,isSelectable:n,name:e,now:e===t},e))})}const{createElement:Ie,useCallback:Ge,useMemo:He,useState:Ye,useEffect:Ke}=a;function $e(){return r("div",{className:me.zapWrapper,children:r(ne,{size:16})})}const Ve=u((e,{name:t,delay:n})=>{const r=v(e),i=O(e),o=E(e),a=M(e),s=_(e),c=r[t],{all:l,type:d,now:u}=c;return{all:l,delay:n,hideUnavailableProxies:a,proxySortBy:o,proxies:r,type:d,now:u,isOpen:i[`proxyGroup:${t}`],latencyTestUrl:s}})(function({name:e,all:t,delay:n,hideUnavailableProxies:a,proxySortBy:s,proxies:c,type:l,now:d,isOpen:u,latencyTestUrl:p,apiConfig:m,dispatch:v}){const y=fe(t,n,a,s,c),{data:_}=b(["/version",m],()=>k("/version",m)),O=He(()=>["Selector",_.meta&&"Fallback",_.meta&&"URLTest"].includes(l),[l,_.meta]),{app:{updateCollapsibleIsOpen:E},proxies:{requestDelayForProxies:M}}=g(),N=Ge(()=>{E("proxyGroup",e,!u)},[u,E,e]),T=Ge(t=>{O&&v(w(m,e,t))},[m,v,e,O]),[S,A]=Ye(!1),L=Ge(async()=>{A(!0);try{!0===_.meta?(await x(m,e,p),await v(C(m))):(await M(m,y),await v(C(m)))}catch(t){}A(!1)},[y,m,v,e,_.meta]),[D,B]=Ye(window.innerWidth),j=()=>{B(window.innerWidth)};return Ke(()=>(window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)),[]),i("div",{className:me.group,children:[i("div",{style:{display:"flex",alignItems:"center",justifyContent:D>768?"start":"space-between"},children:[r(de,{name:e,type:l,toggle:N,qty:y.length}),r("div",{style:{display:"flex"},children:i(f,D>768?{children:[r(o,{kind:"minimal",onClick:N,className:me.btn,title:"Toggle collapsible section",children:r("span",{className:h(me.arrow,{[me.isOpen]:u}),children:r(W,{size:20})})}),r(o,{title:"Test latency",kind:"minimal",onClick:L,isLoading:S,children:r($e,{})})]}:{children:[r(o,{title:"Test latency",kind:"minimal",onClick:L,isLoading:S,children:r($e,{})}),r(o,{kind:"minimal",onClick:N,className:me.btn,title:"Toggle collapsible section",children:r("span",{className:h(me.arrow,{[me.isOpen]:u}),children:r(W,{size:20})})})]})})]}),Ie(u?Ue:We,{all:y,now:d,isSelectable:O,itemOnTapCallback:T})]})}),{useCallback:Xe,useState:Ze}=a;const{useState:Qe,useCallback:Je}=a;function et({isLoading:e}){return e?r(K,{children:r(ne,{width:16,height:16})}):r(ne,{width:16,height:16})}function tt({dispatch:e,apiConfig:t,proxyProviders:n}){const{t:i}=S(),[o,a]=function({dispatch:e,apiConfig:t}){const[n,r]=Qe(!1);return[Je(()=>{n||(r(!0),e(A(t)).then(()=>r(!1),()=>r(!1)))},[t,e,n]),n]}({dispatch:e,apiConfig:t}),[s,c]=function({dispatch:e,apiConfig:t,names:n}){const[r,i]=Ze(!1);return[Xe(async()=>{if(!r){i(!0);try{await e(T(t,n))}catch(o){}i(!1)}},[t,e,n,r]),r]}({apiConfig:t,dispatch:e,names:n.map(e=>e.name)});return r(G,{icon:r(et,{isLoading:a}),onClick:o,text:i("Test Latency"),style:H,children:n.length>0?r(Y,{text:i("update_all_proxy_provider"),onClick:s,children:r($,{isRotating:c})}):null})}var nt=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some(function(e,r){return e[0]===t&&(n=r,!0)}),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var i=r[n];e.call(t,i[1],i[0])}},t}()}(),rt="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,it="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),ot="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(it):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)};var at=["top","right","bottom","left","width","height","size","weight"],st="undefined"!=typeof MutationObserver,ct=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,i=0;function o(){n&&(n=!1,e()),r&&s()}function a(){ot(o)}function s(){var e=Date.now();if(n){if(e-i<2)return;r=!0}else n=!0,r=!1,setTimeout(a,t);i=e}return s}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),e.length>0},e.prototype.connect_=function(){rt&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),st?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){rt&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;at.some(function(e){return!!~n.indexOf(e)})&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),lt=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},dt=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||it},ut=yt(0,0,0,0);function ht(e){return parseFloat(e)||0}function pt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(t,n){return t+ht(e["border-"+n+"-width"])},0)}function ft(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return ut;var r=dt(e).getComputedStyle(e),i=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var i=r[n],o=e["padding-"+i];t[i]=ht(o)}return t}(r),o=i.left+i.right,a=i.top+i.bottom,s=ht(r.width),c=ht(r.height);if("border-box"===r.boxSizing&&(Math.round(s+o)!==t&&(s-=pt(r,"left","right")+o),Math.round(c+a)!==n&&(c-=pt(r,"top","bottom")+a)),!function(e){return e===dt(e).document.documentElement}(e)){var l=Math.round(s+o)-t,d=Math.round(c+a)-n;1!==Math.abs(l)&&(s-=l),1!==Math.abs(d)&&(c-=d)}return yt(i.left,i.top,s,c)}var mt="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof dt(e).SVGGraphicsElement}:function(e){return e instanceof dt(e).SVGElement&&"function"==typeof e.getBBox};function vt(e){return rt?mt(e)?function(e){var t=e.getBBox();return yt(0,0,t.width,t.height)}(e):ft(e):ut}function yt(e,t,n,r){return{x:e,y:t,width:n,height:r}}var _t=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=yt(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=vt(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),bt=function(e,t){var n,r,i,o,a,s,c,l=(r=(n=t).x,i=n.y,o=n.width,a=n.height,s="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,c=Object.create(s.prototype),lt(c,{x:r,y:i,width:o,height:a,top:i,right:r+o,bottom:a+i,left:r}),c);lt(this,{target:e,contentRect:l})},gt=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new nt,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof dt(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new _t(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof dt(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new bt(e.target,e.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),wt="undefined"!=typeof WeakMap?new WeakMap:new nt,xt=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=ct.getInstance(),r=new gt(t,n,this);wt.set(this,r)};["observe","unobserve","disconnect"].forEach(function(e){xt.prototype[e]=function(){var t;return(t=wt.get(this))[e].apply(t,arguments)}});var Ct=void 0!==it.ResizeObserver?it.ResizeObserver:xt;const{memo:kt,useState:Ot,useRef:Et,useEffect:Mt}=t;const Nt={initialOpen:{height:"auto",transition:{duration:0}},open:e=>({height:e,opacity:1,visibility:"visible",transition:{duration:.3}}),closed:{height:0,opacity:0,visibility:"hidden",overflowY:"hidden",transition:{duration:.3}}},Tt={open:{},closed:{}},St=kt(({children:e,isOpen:t})=>{const n=L.read().motion,i=function(e){const t=Et();return Mt(()=>{t.current=e},[e]),t.current}(t),[o,{height:a}]=function(){const e=Et(),[t,n]=Ot({height:0});return Mt(()=>{const t=new Ct(([e])=>n(e.contentRect));return e.current&&t.observe(e.current),()=>t.disconnect()},[]),[e,t]}();return r("div",{children:r(n.div,{animate:t&&i===t?"initialOpen":t?"open":"closed",custom:a,variants:Nt,children:r(n.div,{variants:Tt,ref:o,children:e})})})}),At="_updatedAt_1d817_4",Lt="_body_1d817_12",Dt="_actionFooter_1d817_25",Bt="_refresh_1d817_35",{useState:jt,useCallback:Pt}=a;const zt={rest:{scale:1},pressed:{scale:.95}},Rt={rest:{rotate:0},hover:{rotate:360,transition:{duration:.3}}};function qt(e,t=2){if(!+e)return"0 Bytes";const n=t<0?0:t,r=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,r)).toFixed(n))} ${["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}`}function Ft(){const e=L.read().motion;return r(e.div,{className:Bt,variants:zt,initial:"rest",whileHover:"hover",whileTap:"pressed",children:r(e.div,{className:"flexCenter",variants:Rt,children:r(Z,{size:16})})})}const Ut=u((e,{proxies:t,name:n})=>{const r=M(e),i=y(e),o=O(e);return{apiConfig:B(e),proxies:t,delay:i,hideUnavailableProxies:r,proxySortBy:E(e),isOpen:o[`proxyProvider:${n}`]}})(function({name:e,proxies:t,delay:n,hideUnavailableProxies:a,proxySortBy:s,vehicleType:c,updatedAt:l,subscriptionInfo:d,isOpen:u,dispatch:p,apiConfig:f}){const m=fe(t,n,a,s),[v,y]=jt(!1),_=function({dispatch:e,apiConfig:t,name:n}){return Xe(()=>e(N(t,n)),[t,e,n])}({dispatch:p,apiConfig:f,name:e}),b=Pt(async()=>{y(!0),await p(D(f,e)),y(!1)},[f,p,e,y]),{app:{updateCollapsibleIsOpen:w}}=g(),x=Pt(()=>{w("proxyProvider",e,!u)},[u,w,e]),C=X(new Date(l),new Date),k=d?qt(d.Total):0,O=d?qt(d.Download+d.Upload):0,E=d?((d.Download+d.Upload)/d.Total*100).toFixed(2):0;return i("div",{className:Lt,children:[i("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"space-between"},children:[r(de,{name:e,toggle:x,type:c,isOpen:u,qty:m.length}),i("div",{style:{display:"flex"},children:[r(o,{kind:"minimal",onClick:x,className:me.btn,title:"Toggle collapsible section",children:r("span",{className:h(me.arrow,{[me.isOpen]:u}),children:r(W,{size:20})})}),r(o,{kind:"minimal",start:r(Ft,{}),onClick:_}),r(o,{kind:"minimal",start:r(ne,{size:16}),onClick:b,isLoading:v})]})]}),i("div",{className:At,children:[d&&i("small",{children:[O," / ",k," ( ",E,"% )    Expire: ",(()=>{if(0===d.Expire)return"Null";const e=new Date(1e3*d.Expire);return e.getFullYear()+"-"+((e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-")+((e.getDate()<10?"0"+e.getDate():e.getDate())+" ")})()," "]}),r("br",{}),i("small",{children:["Updated ",C," ago"]})]}),i(St,{isOpen:u,children:[r(Ue,{all:m}),i("div",{className:Dt,children:[r(o,{text:"Update",start:r(Ft,{}),onClick:_}),r(o,{text:"Health Check",start:r(ne,{size:16}),onClick:b,isLoading:v})]})]}),r(St,{isOpen:!u,children:r(We,{all:m})})]})});function Wt({items:e}){return 0===e.length?null:i(f,{children:[r(j,{title:"Proxy Provider"}),r("div",{children:e.map(e=>r(Ut,{name:e.name,proxies:e.proxies,type:e.type,vehicleType:e.vehicleType,updatedAt:e.updatedAt,subscriptionInfo:e.subscriptionInfo},e.name))})]})}const It="_labeledInput_cmki0_1",Gt=[["Natural","order_natural"],["LatencyAsc","order_latency_asc"],["LatencyDesc","order_latency_desc"],["NameAsc","order_name_asc"],["NameDesc","order_name_desc"]],{useCallback:Ht}=a;const Yt=u(e=>({appConfig:{proxySortBy:E(e),hideUnavailableProxies:M(e),autoCloseOldConns:z(e)}}))(function({appConfig:e}){const{app:{updateAppConfig:t}}=g(),n=Ht(e=>{t("proxySortBy",e.target.value)},[t]),o=Ht(e=>{t("hideUnavailableProxies",e)},[t]),{t:a}=S();return i(f,{children:[i("div",{className:It,children:[r("span",{children:a("sort_in_grp")}),r("div",{children:r(Q,{options:Gt.map(e=>[e[0],a(e[1])]),selected:e.proxySortBy,onChange:n})})]}),r("hr",{}),i("div",{className:It,children:[r("span",{children:a("hide_unavail_proxies")}),r("div",{children:r(P,{name:"hideUnavailableProxies",checked:e.hideUnavailableProxies,onChange:o})})]}),i("div",{className:It,children:[r("span",{children:a("auto_close_conns")}),r("div",{children:r(P,{name:"autoCloseOldConns",checked:e.autoCloseOldConns,onChange:e=>t("autoCloseOldConns",e)})})]})]})});function Kt({color:e="currentColor",size:t=24}){return i("svg",{fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:t,height:t,stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r("path",{d:"M2 6h9M18.5 6H22"}),r("circle",{cx:"16",cy:"6",r:"2"}),r("path",{d:"M22 18h-9M6 18H2"}),r("circle",{r:"2",transform:"matrix(-1 0 0 1 8 18)"})]})}const $t="_topBar_15n7g_4",Vt="_topBarRight_15n7g_16",Xt="_textFilterContainer_15n7g_25",Zt="_group_15n7g_32",{useState:Qt,useEffect:Jt,useCallback:en,useRef:tn}=a;const nn=u(e=>({apiConfig:B(e),groupNames:q(e),proxyProviders:F(e),delay:y(e),showModalClosePrevConns:U(e)}))(function({dispatch:e,groupNames:t,delay:n,proxyProviders:a,apiConfig:s,showModalClosePrevConns:c}){const d=tn({}),u=en(()=>{d.current.startAt=Date.now(),e(C(s)).then(()=>{d.current.completeAt=Date.now()})},[s,e]);Jt(()=>{u();const e=()=>{d.current.startAt&&Date.now()-d.current.startAt>3e4&&u()};return window.addEventListener("focus",e,!1),()=>window.removeEventListener("focus",e,!1)},[u]);const[h,p]=Qt(!1),m=en(()=>{p(!1)},[]),{proxies:{closeModalClosePrevConns:v,closePrevConnsAndTheModal:y}}=g(),{t:_}=S();return i(f,{children:[r(I,{isOpen:h,onRequestClose:m,children:r(Yt,{})}),i("div",{className:$t,children:[r(j,{title:_("Proxies")}),i("div",{className:Vt,children:[r("div",{className:Xt,children:r(V,{textAtom:l,placeholder:_("Search")})}),r(R,{label:_("settings"),children:r(o,{kind:"minimal",onClick:()=>p(!0),children:r(Kt,{size:16})})})]})]}),r("div",{children:t.map(t=>r("div",{className:Zt,children:r(Ve,{name:t,delay:n,apiConfig:s,dispatch:e})},t))}),r(Wt,{items:a}),r("div",{style:{height:60}}),r(tt,{dispatch:e,apiConfig:s,proxyProviders:a}),r(I,{isOpen:c,onRequestClose:v,children:r(se,{onClickPrimaryButton:()=>y(s),onClickSecondaryButton:v})})]})});export{nn as default};
