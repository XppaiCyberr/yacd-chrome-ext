import{r as e,R as n,p as a,c as r,b as t,j as i,s as l,t as s,v as o,w as c,x as d,d as p,y as u,g as m,z as v,u as h,A as f,D as g,E as y,F as b,G as k,H as w,J as C,K as _,L as O,C as N,S as x,N as j,B as E,O as P,P as S,Q as L}from"./popup.js";import{r as z}from"./logs2.js";import{S as I}from"./Select.js";import{I as T,S as R}from"./Input.js";import{R as M}from"./rotate-cw.js";function U(){return U=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},U.apply(this,arguments)}function B(e,n){if(null==e)return{};var a,r,t=function(e,n){if(null==e)return{};var a,r,t={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],n.indexOf(a)>=0||(t[a]=e[a]);return t}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(t[a]=e[a])}return t}var D=e.forwardRef(function(e,a){var r=e.color,t=void 0===r?"currentColor":r,i=e.size,l=void 0===i?24:i,s=B(e,["color","size"]);return n.createElement("svg",U({ref:a,xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},s),n.createElement("polyline",{points:"8 17 12 21 16 17"}),n.createElement("line",{x1:"12",y1:"12",x2:"12",y2:"21"}),n.createElement("path",{d:"M20.88 18.09A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.29"}))});D.propTypes={color:a.string,size:a.oneOfType([a.string,a.number])},D.displayName="DownloadCloud";const A=D;function W(){return W=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},W.apply(this,arguments)}function H(e,n){if(null==e)return{};var a,r,t=function(e,n){if(null==e)return{};var a,r,t={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],n.indexOf(a)>=0||(t[a]=e[a]);return t}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(t[a]=e[a])}return t}var V=e.forwardRef(function(e,a){var r=e.color,t=void 0===r?"currentColor":r,i=e.size,l=void 0===i?24:i,s=H(e,["color","size"]);return n.createElement("svg",W({ref:a,xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},s),n.createElement("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),n.createElement("polyline",{points:"16 17 21 12 16 7"}),n.createElement("line",{x1:"21",y1:"12",x2:"9",y2:"12"}))});V.propTypes={color:a.string,size:a.oneOfType([a.string,a.number])},V.displayName="LogOut";const G=V;function F(){return F=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},F.apply(this,arguments)}function J(e,n){if(null==e)return{};var a,r,t=function(e,n){if(null==e)return{};var a,r,t={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],n.indexOf(a)>=0||(t[a]=e[a]);return t}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(t[a]=e[a])}return t}var K=e.forwardRef(function(e,a){var r=e.color,t=void 0===r?"currentColor":r,i=e.size,l=void 0===i?24:i,s=J(e,["color","size"]);return n.createElement("svg",F({ref:a,xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},s),n.createElement("polyline",{points:"3 6 5 6 21 6"}),n.createElement("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),n.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),n.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"}))});K.propTypes={color:a.string,size:a.oneOfType([a.string,a.number])},K.displayName="Trash2";const Q=K,$="_root_1vck5_4",q="_section_1vck5_5",X="_wrapSwitch_1vck5_30",Y="_sep_1vck5_36",Z="_label_1vck5_49",ee="_fieldset_1hnn2_1",ne="_input_1hnn2_10",ae="_cnt_1hnn2_10";function re({OptionComponent:e,optionPropsList:n,selectedIndex:a,onChange:l}){const s=r("visually-hidden",ne),o=e=>{l(e.target.value)};return t("fieldset",{className:ee,children:n.map((n,r)=>i("label",{children:[t("input",{type:"radio",checked:a===r,name:"selection",value:r,"aria-labelledby":"traffic chart type "+r,onChange:o,className:s}),t("div",{className:ae,children:t(e,{...n})})]},r))})}const{useMemo:te}=d,ie={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},le=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],se=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],oe=le;function ce({id:e}){const n=l.read(),a=te(()=>({labels:oe,datasets:[{...s,...o[e].up,data:le},{...s,...o[e].down,data:se}]}),[e]),r="chart-"+e;return c(n.Chart,r,a,null,ie),t("div",{style:{width:80,padding:5},children:t("canvas",{id:r})})}const{useEffect:de,useState:pe,useCallback:ue,useRef:me}=d,ve=[{id:0},{id:1},{id:2},{id:3}],he=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],fe=[{key:"port",label:"Http Port"},{key:"socks-port",label:"Socks5 Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"},{key:"mitm-port",label:"MITM Port"}],ge=[["zh-cn","简体中文"],["zh-tw","繁體中文"],["en","English"]],ye=[["direct","Direct"],["rule","Rule"],["script","Script"],["global","Global"]],be=[["gvisor","gVisor"],["system","System"],["lwip","LWIP"]],ke=p(e=>({selectedChartStyleIndex:S(e),latencyTestUrl:L(e),apiConfig:m(e)}))(function({dispatch:e,configs:n,selectedChartStyleIndex:a,latencyTestUrl:r,apiConfig:l}){var s,o,c,d;const{t:p,i18n:u}=h(),[m,v]=pe(n),S=me(n);de(()=>{S.current!==n&&v(n),S.current=n},[n]);const L=ue(()=>{e(f("apiConfig"))},[e]),U=ue((e,n)=>{v({...m,[e]:n})},[m]),B=ue((e,n)=>{const a={...m.tun,[e]:n};v({...m,tun:{...a}})},[m]),D=ue(({name:n,value:a})=>{switch(n){case"mode":case"log-level":case"allow-lan":case"sniffing":U(n,a),e(g(l,{[n]:a})),"log-level"===n&&z({...l,logLevel:a});break;case"mitm-port":case"redir-port":case"socks-port":case"mixed-port":case"port":if(""!==a){const e=parseInt(a,10);if(e<0||e>65535)return}U(n,a);break;case"enable":case"stack":B(n,a),e(g(l,{tun:{[n]:a}}));break;default:return}},[l,e,U,B]),{selectChartStyleIndex:W,updateAppConfig:H}=y(),V=ue(n=>{const{name:a,value:r}=n.target;switch(a){case"port":case"socks-port":case"mixed-port":case"redir-port":case"mitm-port":{const n=parseInt(r,10);if(n<0||n>65535)return;e(g(l,{[a]:n}));break}case"latencyTestUrl":H(a,r);break;case"device name":case"interface name":break;default:throw new Error(`unknown input name ${a}`)}},[l,e,H]),F=ue(()=>{e(b(l))},[l,e]),J=ue(()=>{e(k(l))},[l,e]),K=ue(()=>{e(w(l))},[l,e]),ee=ue(()=>{e(C(l))},[l,e]),ne=ue(()=>{e(_(l))},[l,e]),{data:ae}=O(["/version",l],()=>P("/version",l));return i("div",{children:[t(N,{title:p("Config")}),i("div",{className:$,children:[ae.meta&&ae.premium||fe.map(e=>void 0!==m[e.key]?i("div",{children:[t("div",{className:Z,children:e.label}),t(T,{name:e.key,value:m[e.key],onChange:({target:{name:e,value:n}})=>D({name:e,value:n}),onBlur:V})]},e.key):null),i("div",{children:[t("div",{className:Z,children:"Mode"}),t(I,{options:ye,selected:m.mode.toLowerCase(),onChange:e=>D({name:"mode",value:e.target.value})})]}),i("div",{children:[t("div",{className:Z,children:"Log Level"}),t(I,{options:he,selected:m["log-level"].toLowerCase(),onChange:e=>D({name:"log-level",value:e.target.value})})]}),ae.meta&&ae.premium||i("div",{children:[t("div",{className:Z,children:p("allow_lan")}),t("div",{className:X,children:t(x,{name:"allow-lan",checked:m["allow-lan"],onChange:e=>D({name:"allow-lan",value:e})})})]}),ae.meta&&!ae.premium&&i("div",{children:[t("div",{className:Z,children:p("tls_sniffing")}),t("div",{className:X,children:t(x,{name:"sniffing",checked:m.sniffing,onChange:e=>D({name:"sniffing",value:e})})})]})]}),t("div",{className:Y,children:t("div",{})}),ae.meta&&i(j,{children:[ae.premium||i("div",{children:[i("div",{className:q,children:[i("div",{children:[t("div",{className:Z,children:p("enable_tun_device")}),t("div",{className:X,children:t(x,{checked:null==(s=m.tun)?void 0:s.enable,onChange:e=>D({name:"enable",value:e})})})]}),i("div",{children:[t("div",{className:Z,children:"TUN IP Stack"}),t(I,{options:be,selected:null==(c=null==(o=m.tun)?void 0:o.stack)?void 0:c.toLowerCase(),onChange:e=>D({name:"stack",value:e.target.value})})]}),i("div",{children:[t("div",{className:Z,children:"Device Name"}),t(T,{name:"device name",value:null==(d=m.tun)?void 0:d.device,onChange:V})]}),i("div",{children:[t("div",{className:Z,children:"Interface Name"}),t(T,{name:"interface name",value:m["interface-name"]||"",onChange:V})]})]}),t("div",{className:Y,children:t("div",{})})]}),i("div",{className:q,children:[i("div",{children:[t("div",{className:Z,children:"Reload"}),t(E,{start:t(M,{size:16}),label:p("reload_config_file"),onClick:F})]}),ae.meta&&!ae.premium&&i("div",{children:[t("div",{className:Z,children:"GEO Databases"}),t(E,{start:t(A,{size:16}),label:p("update_geo_databases_file"),onClick:ee})]}),i("div",{children:[t("div",{className:Z,children:"FakeIP"}),t(E,{start:t(Q,{size:16}),label:p("flush_fake_ip_pool"),onClick:ne})]}),ae.meta&&!ae.premium&&i("div",{children:[t("div",{className:Z,children:"Restart"}),t(E,{start:t(M,{size:16}),label:p("restart_core"),onClick:J})]}),ae.meta&&!ae.premium&&i("div",{children:[t("div",{className:Z,children:"⚠️ Upgrade ⚠️"}),t(E,{start:t(M,{size:16}),label:p("upgrade_core"),onClick:K})]})]}),t("div",{className:Y,children:t("div",{})})]}),i("div",{className:q,children:[i("div",{children:[t("div",{className:Z,children:p("latency_test_url")}),t(R,{name:"latencyTestUrl",type:"text",value:r,onBlur:V})]}),i("div",{children:[t("div",{className:Z,children:p("lang")}),t("div",{children:t(I,{options:ge,selected:u.language,onChange:e=>u.changeLanguage(e.target.value)})})]}),i("div",{children:[t("div",{className:Z,children:p("chart_style")}),t(re,{OptionComponent:ce,optionPropsList:ve,selectedIndex:a,onChange:W})]}),i("div",{children:[i("div",{className:Z,children:[p("current_backend"),t("p",{children:Ce(ae)+(null==l?void 0:l.baseURL)})]}),t("div",{className:Z,children:"Action"}),t(E,{start:t(G,{size:16}),label:p("switch_backend"),onClick:L})]})]})]})}),we=p(e=>({configs:u(e),apiConfig:m(e)}))(function({dispatch:e,configs:n,apiConfig:a}){return de(()=>{e(v(a))},[e,a]),t(ke,{configs:n})});function Ce(e){return e&&e.meta&&!e.premium?"Clash.Meta ":e&&e.meta&&e.premium?"sing-box ":"Clash Premium"}export{we as default};
